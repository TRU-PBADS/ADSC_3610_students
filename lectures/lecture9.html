
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lecture 9: Introduction to PySpark &#8212; ADSC 3610 - Database Systems in Applied Data Science II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/lecture9';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Midterm 1 instruction" href="midterm1.html" />
    <link rel="prev" title="Course recap MongoDB" href="course_recap.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../syllabus.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/TRU_Logo.png" class="logo__image only-light" alt="ADSC 3610 - Database Systems in Applied Data Science II - Home"/>
    <script>document.write(`<img src="../_static/TRU_Logo.png" class="logo__image only-dark" alt="ADSC 3610 - Database Systems in Applied Data Science II - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../syllabus.html">
                    ADSC 3610 - Database Systems in Applied Data Science II - Syllabus
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture1.html">Lecture 1: Introduction to Non-Relational Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture2.html">Lecture 2: Introduction to MongoDB and the document model</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture3.html">Lecture 3: MongoDB Atlas and connecting to MongoDB database</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture4.html">Lecture 4: Data modelling in MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture5.html">Lecture 5: Schema design patterns in MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture6.html">Lecture 6: CRUD operations in MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture7.html">Lecture 7: Aggregation operations in MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture8.html">Lecture 8: ACID transactions in MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="course_recap.html">Course recap MongoDB</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 9: Introduction to PySpark</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Midterms Information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="midterm1.html">Midterm 1 instruction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Installation Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation_mac.html">Installation instruction for macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation_windows.html">Installation instruction for Windows</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Worksheet solution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../worksheets/source/worksheet1.html">Worksheet 1: Introduction to noSQL databases and document model with MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/source/worksheet2.html">Worksheet 2: Data modelling with MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/source/worksheet3/worksheet3.html">Worksheet 3: CRUD operations in MongoDB</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/lecture9.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 9: Introduction to PySpark</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apache-spark-an-unified-engine-for-large-scale-analysis">Apache Spark - An unified engine for large-scale analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-benefits-of-spark">Key benefits of Spark:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-big-idea-behind-distributed-computing">The big idea behind distributed computing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-yellow-phone-book-analogy">The Yellow Phone Book Analogy</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#single-worker-non-distributed-computing">Single Worker (Non-Distributed Computing)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-workers-distributed-computing">Multiple Workers (Distributed Computing)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts-in-distributed-computing">Key Concepts in Distributed Computing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-and-hadoop-s-ecosystem">Spark and Hadoop’s ecosystem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hadoop-ecosystem">Hadoop Ecosystem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-ecosystem">Spark Ecosystem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-differences-hadoop-vs-spark">Key Differences: Hadoop vs. Spark</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hadoop-use-cases">Hadoop use cases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-use-cases">Spark use cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-and-databricks">Spark and Databricks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-databricks">Introduction to Databricks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-features-of-databricks">Key Features of Databricks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-to-apache-spark">Relation to Apache Spark</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#benefits-of-using-databricks-with-spark">Benefits of Using Databricks with Spark</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sign-up-for-databricks-community-edition">Sign up for Databricks Community edition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started-with-pyspark-on-databricks">Getting started with PySpark on databricks</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-9-introduction-to-pyspark">
<h1>Lecture 9: Introduction to PySpark<a class="headerlink" href="#lecture-9-introduction-to-pyspark" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<p>By the end of this lecture, students should be able to:</p>
<ul class="simple">
<li><p>Understand what is Spark and its main components</p></li>
<li><p>How Spark is different from Hadoop’s Map Reduce</p></li>
<li><p>What are the key use case of Spark</p></li>
<li><p>Set up a databricks workspace</p></li>
</ul>
</section>
<section id="apache-spark-an-unified-engine-for-large-scale-analysis">
<h2>Apache Spark - An unified engine for large-scale analysis<a class="headerlink" href="#apache-spark-an-unified-engine-for-large-scale-analysis" title="Link to this heading">#</a></h2>
<p>Apache Spark is an unified analytics engine designed for large-scale data processing. It offers high-level APIs in Java, Scala, Python, and R, along with an optimized engine that supports general execution graphs. Additionally, Spark includes a robust suite of higher-level tools such as Spark SQL for SQL and structured data processing, pandas API on Spark for handling pandas workloads, MLlib for machine learning, GraphX for graph processing, and Structured Streaming for incremental computation and stream processing.</p>
<p><img alt="" src="https://www.databricks.com/en-website-assets/static/fc5d7c6f8bc8dab49fefccf3e36b9f7f/19830.png" /></p>
<section id="key-benefits-of-spark">
<h3>Key benefits of Spark:<a class="headerlink" href="#key-benefits-of-spark" title="Link to this heading">#</a></h3>
<p><strong>Speed</strong></p>
<p>Engineered from the bottom-up for performance, <strong>Spark can be 100x faster than Hadoop for large scale data processing</strong> by exploiting in memory computing and other optimizations. Spark is also fast when data is stored on disk, and currently holds the world record for large-scale on-disk sorting.</p>
<p><strong>Ease of Use</strong></p>
<p>Spark has easy-to-use APIs for operating on large datasets. This includes a collection of over 100 operators for transforming data and familiar data frame APIs for manipulating semi-structured data.</p>
<p><strong>A Unified Engine</strong></p>
<p>Spark comes packaged with higher-level libraries, including support for SQL queries, streaming data, machine learning and graph processing. These standard libraries increase developer productivity and can be seamlessly combined to create complex workflows.</p>
<a class="reference internal image-reference" href="https://cdn.prod.website-files.com/5e724862760345325327026c/5fa7ecda6639f6566345729b_Apache%20Spark%20Ecosystem%20PNG.png"><img alt="" src="https://cdn.prod.website-files.com/5e724862760345325327026c/5fa7ecda6639f6566345729b_Apache%20Spark%20Ecosystem%20PNG.png" style="width: 500px;" /></a>
</section>
</section>
<section id="the-big-idea-behind-distributed-computing">
<h2>The big idea behind distributed computing<a class="headerlink" href="#the-big-idea-behind-distributed-computing" title="Link to this heading">#</a></h2>
<p>Distributed computing is a model in which components of a software system are shared among multiple computers to improve efficiency and performance. To understand this concept, let’s use the analogy of searching through a yellow phone book.</p>
<section id="the-yellow-phone-book-analogy">
<h3>The Yellow Phone Book Analogy<a class="headerlink" href="#the-yellow-phone-book-analogy" title="Link to this heading">#</a></h3>
<p>Imagine you have a massive yellow phone book with millions of entries, and you need to find the phone number of a specific person. Doing this task alone would be time-consuming and tedious. Now, let’s break down how distributed computing can make this process faster and more efficient.</p>
<a class="reference internal image-reference" href="https://i.redd.it/ly7a0bgzsq721.jpg"><img alt="" src="https://i.redd.it/ly7a0bgzsq721.jpg" style="width: 300px;" /></a>
<section id="single-worker-non-distributed-computing">
<h4>Single Worker (Non-Distributed Computing)<a class="headerlink" href="#single-worker-non-distributed-computing" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Scenario</strong>: One person (a single computer) is tasked with finding the phone number.</p></li>
<li><p><strong>Process</strong>: The person starts from the first page and goes through each entry sequentially until they find the desired phone number.</p></li>
<li><p><strong>Time</strong>: This process can take a long time, especially if the phone book is enormous.</p></li>
<li><p><strong>Vertical scaling</strong>: Enhancing the capabilities of a single computer by adding more CPU, memory, or faster storage.</p></li>
</ul>
</section>
<section id="multiple-workers-distributed-computing">
<h4>Multiple Workers (Distributed Computing)<a class="headerlink" href="#multiple-workers-distributed-computing" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Scenario</strong>: You have a team of people (multiple computers) to help you search through the phone book.</p></li>
<li><p><strong>Process</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Divide the Task</strong>: Split the phone book into equal sections and assign each section to a different person.</p></li>
<li><p><strong>Parallel Search</strong>: Each person searches their assigned section simultaneously.</p></li>
<li><p><strong>Combine Results</strong>: Once a person finds the phone number, they inform the rest of the team, and the search stops.</p></li>
</ol>
</li>
<li><p><strong>Time</strong>: The search process is significantly faster because multiple sections are being searched at the same time.</p></li>
<li><p><strong>Horizontal scaling</strong>: Adding more computers to the system to share the workload.</p></li>
</ul>
</section>
<section id="key-concepts-in-distributed-computing">
<h4>Key Concepts in Distributed Computing<a class="headerlink" href="#key-concepts-in-distributed-computing" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Parallelism</strong>: Just like multiple people searching different sections of the phone book simultaneously, distributed computing involves multiple processors working on different parts of a task at the same time.</p></li>
<li><p><strong>Scalability</strong>: Adding more workers (computers) can further speed up the search process. Similarly, distributed systems can scale by adding more nodes to handle larger workloads.</p></li>
<li><p><strong>Fault Tolerance</strong>: If one person gets tired or makes a mistake, others can continue the search. In distributed computing, if one node fails, other nodes can take over its tasks, ensuring the system remains operational.</p></li>
<li><p><strong>Coordination</strong>: Effective communication and coordination are essential. In our analogy, workers need to inform each other when the phone number is found. In distributed systems, nodes must coordinate to share data and results.</p></li>
</ul>
<a class="reference internal image-reference" href="https://miro.medium.com/v2/resize:fit:1122/1*gee5Zkih2dZ7tYWRgmRbkw.png"><img alt="" src="https://miro.medium.com/v2/resize:fit:1122/1*gee5Zkih2dZ7tYWRgmRbkw.png" style="width: 600px;" /></a>
</section>
</section>
</section>
<section id="spark-and-hadoop-s-ecosystem">
<h2>Spark and Hadoop’s ecosystem<a class="headerlink" href="#spark-and-hadoop-s-ecosystem" title="Link to this heading">#</a></h2>
<p><img alt="" src="https://tutorials.freshersnow.com/wp-content/uploads/2020/06/Hadoop-Ecosystem.png" /></p>
<p>Credit: https://tutorials.freshersnow.com/hadoop-tutorial/hadoop-ecosystem-components/</p>
<section id="hadoop-ecosystem">
<h3>Hadoop Ecosystem<a class="headerlink" href="#hadoop-ecosystem" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Hadoop Distributed File System (HDFS)</strong>: is a special file system that stores large datasets across multiple computers. These computers are called Hadoop clusters.</p></li>
<li><p><strong>MapReduce</strong>: allows programs to break large data processing tasks into smaller ones and runs them in parallel on multiple servers.</p></li>
<li><p><strong>YARN (Yet Another Resource Negotiator)</strong>: schedules tasks and allocates resources to applications running on Hadoop.</p></li>
</ul>
</section>
<section id="spark-ecosystem">
<h3>Spark Ecosystem<a class="headerlink" href="#spark-ecosystem" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Spark Core</strong>: The foundation of the Spark framework, responsible for basic I/O functionalities, task scheduling, and memory management.</p></li>
<li><p><strong>Spark SQL</strong>: Allows querying of structured data via SQL and supports integration with various data sources.</p></li>
<li><p><strong>Spark Streaming</strong>: Enables real-time data processing and analytics.</p></li>
<li><p><strong>MLlib</strong>: A library for scalable machine learning algorithms.</p></li>
<li><p><strong>GraphX</strong>: A library for graph processing and analysis.</p></li>
<li><p><strong>SparkR</strong>: An R package that provides a lightweight frontend to use Apache Spark from R.</p></li>
</ul>
</section>
<section id="key-differences-hadoop-vs-spark">
<h3>Key Differences: Hadoop vs. Spark<a class="headerlink" href="#key-differences-hadoop-vs-spark" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Hadoop</p></th>
<th class="head"><p>Spark</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Architecture</p></td>
<td><p>Hadoop stores and processes data on external storage.</p></td>
<td><p>Spark stores and process data on internal memory.</p></td>
</tr>
<tr class="row-odd"><td><p>Performance</p></td>
<td><p>Hadoop processes data in batches.</p></td>
<td><p>Spark processes data in real time.</p></td>
</tr>
<tr class="row-even"><td><p>Cost</p></td>
<td><p>Hadoop is affordable.</p></td>
<td><p>Spark is comparatively more expensive.</p></td>
</tr>
<tr class="row-odd"><td><p>Scalability</p></td>
<td><p>Hadoop is easily scalable by adding more nodes.</p></td>
<td><p>Spark is comparatively more challenging.</p></td>
</tr>
<tr class="row-even"><td><p>Machine learning</p></td>
<td><p>Hadoop integrates with external libraries to provide machine learning capabilities.</p></td>
<td><p>Spark has built-in machine learning libraries.</p></td>
</tr>
<tr class="row-odd"><td><p>Security</p></td>
<td><p>Hadoop has strong security features, storage encryption, and access control.</p></td>
<td><p>Spark has basic security. IT relies on you setting up a secure operating environment for the Spark deployment.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="hadoop-use-cases">
<h4>Hadoop use cases<a class="headerlink" href="#hadoop-use-cases" title="Link to this heading">#</a></h4>
<p>Hadoop is most effective for scenarios that involve the following:</p>
<ul class="simple">
<li><p>Processing big data sets in environments where data size exceeds available memory</p></li>
<li><p>Batch processing with tasks that exploit disk read and write operations</p></li>
<li><p>Building data analysis infrastructure with a limited budget</p></li>
<li><p>Completing jobs that are not time-sensitive</p></li>
<li><p>Historical and archive data analysis</p></li>
</ul>
</section>
<section id="spark-use-cases">
<h4>Spark use cases<a class="headerlink" href="#spark-use-cases" title="Link to this heading">#</a></h4>
<p>Spark is most effective for scenarios that involve the following:</p>
<ul class="simple">
<li><p>Dealing with chains of parallel operations by using iterative algorithms</p></li>
<li><p>Achieving quick results with in-memory computations</p></li>
<li><p>Analyzing stream data analysis in real time</p></li>
<li><p>Graph-parallel processing to model data</p></li>
<li><p>All ML applications</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/hadoop_spark.png"><img alt="Googletrend" src="../_images/hadoop_spark.png" style="width: 600px;" /></a>
</section>
</section>
</section>
<section id="spark-and-databricks">
<h2>Spark and Databricks<a class="headerlink" href="#spark-and-databricks" title="Link to this heading">#</a></h2>
<section id="introduction-to-databricks">
<h3>Introduction to Databricks<a class="headerlink" href="#introduction-to-databricks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Databricks</strong>: A cloud-based platform designed to simplify big data processing and analytics. It was founded by the creators of Apache Spark and provides a unified environment for data engineering, data science, and machine learning.</p></li>
</ul>
</section>
<section id="key-features-of-databricks">
<h3>Key Features of Databricks<a class="headerlink" href="#key-features-of-databricks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Managed Spark Environment</strong>: Databricks offers a fully managed Spark environment, which simplifies the deployment, management, and scaling of Spark applications.</p></li>
<li><p><strong>Collaborative Workspace</strong>: Provides a collaborative workspace where data engineers, data scientists, and analysts can work together on data projects.</p></li>
<li><p><strong>Optimized Spark Engine</strong>: Includes performance optimizations over open-source Spark, making it faster and more efficient.</p></li>
<li><p><strong>Integrated Machine Learning</strong>: Simplifies the process of building, training, and deploying machine learning models.</p></li>
<li><p><strong>Interactive Notebooks</strong>: Supports interactive notebooks that allow users to write code, visualize data, and share insights in a single document.</p></li>
</ul>
</section>
<section id="relation-to-apache-spark">
<h3>Relation to Apache Spark<a class="headerlink" href="#relation-to-apache-spark" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Founders</strong>: Databricks was founded by the original creators of Apache Spark, ensuring deep integration and optimization for Spark workloads.</p></li>
<li><p><strong>Enhanced Spark Capabilities</strong>: Databricks enhances Spark’s capabilities by providing additional features such as optimized performance, collaborative tools, and integrated machine learning.</p></li>
<li><p><strong>Unified Analytics Platform</strong>: Combines the power of Spark with additional tools and services to create a comprehensive platform for big data analytics and machine learning.</p></li>
</ul>
</section>
<section id="benefits-of-using-databricks-with-spark">
<h3>Benefits of Using Databricks with Spark<a class="headerlink" href="#benefits-of-using-databricks-with-spark" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Ease of Use</strong>: Simplifies the setup and management of Spark clusters, allowing users to focus on data processing and analysis.</p></li>
<li><p><strong>Scalability</strong>: Automatically scales resources based on workload demands, ensuring efficient use of resources.</p></li>
<li><p><strong>Performance</strong>: Provides performance improvements over open-source Spark, making data processing faster and more efficient.</p></li>
<li><p><strong>Collaboration</strong>: Facilitates collaboration among team members through shared notebooks and integrated workflows.</p></li>
<li><p><strong>Security</strong>: Offers robust security features, including data encryption, access controls, and compliance with industry standards.</p></li>
</ul>
</section>
</section>
<section id="sign-up-for-databricks-community-edition">
<h2>Sign up for Databricks Community edition<a class="headerlink" href="#sign-up-for-databricks-community-edition" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Click <a class="reference external" href="https://databricks.com/try-databricks">Try Databricks</a> here</p></li>
<li><p>Enter your name, company, email, and title, and click Continue.</p></li>
<li><p>On the Choose a cloud provider dialog, click the <strong>Get started with Community Edition</strong> link. You’ll see a page announcing that an email has been sent to the address you provided.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/databricks2.png"><img alt="Databricks" src="../_images/databricks2.png" style="width: 400px;" /></a>
<ol class="arabic simple" start="4">
<li><p>Look for the welcome email and click the link to verify your email address. You are prompted to create your Databricks password.</p></li>
<li><p>When you click Submit, you’ll be taken to the Databricks Community Edition home page</p></li>
</ol>
<a class="reference internal image-reference" href="https://docs.databricks.com/en/_images/landing-aws-ce.png"><img alt="Databricks" src="https://docs.databricks.com/en/_images/landing-aws-ce.png" style="width: 600px;" /></a>
</section>
<section id="getting-started-with-pyspark-on-databricks">
<h2>Getting started with PySpark on databricks<a class="headerlink" href="#getting-started-with-pyspark-on-databricks" title="Link to this heading">#</a></h2>
<p><strong>Spark session</strong></p>
<p>A Spark session is the entry point to programming with Spark. It allows you to create DataFrames, register DataFrames as tables, execute SQL queries, and read data from various sources</p>
<p>You initialize a Spark session using <code class="docutils literal notranslate"><span class="pre">SparkSession.builder</span></code>. The <code class="docutils literal notranslate"><span class="pre">appName</span></code> method sets the name of your application, which can be useful for debugging and monitoring.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>

<span class="c1"># Initialize Spark Session</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;DataFrame Example&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="n">spark</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
            <div>
                <p><b>SparkSession - hive</b></p>
                
        <div>
            <p><b>SparkContext</b></p>

            <p><a href="/?o=839460616079745#setting/sparkui/1008-013007-p8s54f28/driver-7474117560089113638">Spark UI</a></p>

            <dl>
              <dt>Version</dt>
                <dd><code>v3.5.0</code></dd>
              <dt>Master</dt>
                <dd><code>local[*, 4]</code></dd>
              <dt>AppName</dt>
                <dd><code>Databricks Shell</code></dd>
            </dl>
        </div>
        
            </div>
        </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a DataFrame from a list of tuples</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Cathy&quot;</span><span class="p">)]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>

<span class="c1"># show data using databrick display function</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style scoped>
  .table-result-container {
    max-height: 300px;
    overflow: auto;
  }
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
  th, td {
    padding: 5px;
  }
  th {
    text-align: left;
  }
</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>1</td><td>Alice</td></tr><tr><td>2</td><td>Bob</td></tr><tr><td>3</td><td>Cathy</td></tr></tbody></table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show data using pyspark show() function</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+---+-----+
| id| name|
+---+-----+
|  1|Alice|
|  2|  Bob|
|  3|Cathy|
+---+-----+
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="course_recap.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Course recap MongoDB</p>
      </div>
    </a>
    <a class="right-next"
       href="midterm1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Midterm 1 instruction</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apache-spark-an-unified-engine-for-large-scale-analysis">Apache Spark - An unified engine for large-scale analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-benefits-of-spark">Key benefits of Spark:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-big-idea-behind-distributed-computing">The big idea behind distributed computing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-yellow-phone-book-analogy">The Yellow Phone Book Analogy</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#single-worker-non-distributed-computing">Single Worker (Non-Distributed Computing)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-workers-distributed-computing">Multiple Workers (Distributed Computing)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts-in-distributed-computing">Key Concepts in Distributed Computing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-and-hadoop-s-ecosystem">Spark and Hadoop’s ecosystem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hadoop-ecosystem">Hadoop Ecosystem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-ecosystem">Spark Ecosystem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-differences-hadoop-vs-spark">Key Differences: Hadoop vs. Spark</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hadoop-use-cases">Hadoop use cases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-use-cases">Spark use cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spark-and-databricks">Spark and Databricks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-databricks">Introduction to Databricks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-features-of-databricks">Key Features of Databricks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-to-apache-spark">Relation to Apache Spark</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#benefits-of-using-databricks-with-spark">Benefits of Using Databricks with Spark</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sign-up-for-databricks-community-edition">Sign up for Databricks Community edition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started-with-pyspark-on-databricks">Getting started with PySpark on databricks</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Quan Nguyen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>